# 檔案自動清理工具使用說明

## 功能特色

✅ **智能掃描**：自動掃描指定資料夾，找出過期檔案  
✅ **安全預覽**：先預覽要刪除的檔案，確認後再執行  
✅ **完整日誌**：詳細記錄清理過程，方便追蹤  
✅ **錯誤處理**：完善的錯誤處理和權限檢查  
✅ **Windows優化**：特別針對Windows平台優化  
✅ **靈活配置**：支援命令列參數和互動式輸入  

## 安裝需求

- Python 3.7 或更高版本
- Windows 作業系統（主要支援平台）

## 使用方法

### 1. 互動式使用（推薦新手）

```bash
python delete_file_regularly.py
```

程式會引導您輸入：
- 資料夾路徑
- 保留天數
- 是否包含子資料夾

### 2. 命令列使用（進階用戶）

```bash
# 基本使用
python delete_file_regularly.py --path "C:\Users\YourName\Downloads" --days 30

# 不包含子資料夾
python delete_file_regularly.py --path "C:\temp" --days 7 --no-subfolders

# 跳過預覽直接執行
python delete_file_regularly.py --path "C:\logs" --days 30 --no-preview

# 設定日誌級別
python delete_file_regularly.py --path "C:\temp" --days 7 --log-level DEBUG
```

### 3. 命令列參數說明

| 參數 | 說明 | 範例 |
|------|------|------|
| `--path, -p` | 要清理的資料夾路徑 | `--path "C:\Downloads"` |
| `--days, -d` | 保留天數 | `--days 30` |
| `--no-subfolders` | 不包含子資料夾 | `--no-subfolders` |
| `--no-preview` | 跳過預覽直接執行 | `--no-preview` |
| `--log-level` | 日誌級別 | `--log-level DEBUG` |

## 使用範例

### 範例 1：清理下載資料夾（保留30天）
```bash
python delete_file_regularly.py --path "C:\Users\%USERNAME%\Downloads" --days 30
```

### 範例 2：清理暫存檔案（保留7天，不包含子資料夾）
```bash
python delete_file_regularly.py --path "C:\Windows\Temp" --days 7 --no-subfolders
```

### 範例 3：清理日誌檔案（保留90天，直接執行）
```bash
python delete_file_regularly.py --path "C:\logs" --days 90 --no-preview
```

## 安全特性

1. **預覽模式**：預設會先顯示要刪除的檔案列表，確認後才執行
2. **權限檢查**：自動檢查資料夾的讀寫權限
3. **唯讀處理**：自動處理唯讀檔案（移除唯讀屬性後刪除）
4. **錯誤記錄**：詳細記錄刪除失敗的檔案和原因
5. **路徑驗證**：嚴格驗證輸入的資料夾路徑

## 日誌功能

程式會自動在 `logs` 資料夾中建立日誌檔案：
- 檔案名稱：`file_cleanup_YYYYMMDD.log`
- 記錄內容：掃描過程、刪除結果、錯誤訊息
- 日誌級別：DEBUG、INFO、WARNING、ERROR

## 輸出範例

```
檔案自動清理工具
==================================================
請輸入要清理的資料夾路徑: C:\Users\test\Downloads
請輸入保留天數 (超過此天數的檔案將被刪除): 30
是否包含子資料夾? (y/n) [預設: y]: y

正在掃描檔案...

將要刪除的檔案列表：
================================================================================
檔案路徑                                           大小       修改時間            
--------------------------------------------------------------------------------
old_document.pdf                                  2.3 MB     2024-06-15 14:30:25
temp_file.txt                                     1.2 KB     2024-06-10 09:15:40
...logs/old_log.txt                              45.6 KB     2024-06-05 16:22:10
--------------------------------------------------------------------------------
總計：15 個檔案，12.8 MB
================================================================================

清理結果摘要 (預覽模式)：
==================================================
發現過期檔案：15 個
==================================================

確定要刪除這 15 個檔案嗎? (y/n): y

開始實際清理...
正在刪除 (1/15): old_document.pdf
正在刪除 (2/15): temp_file.txt
...

清理結果摘要 (實際清理)：
==================================================
發現過期檔案：15 個
成功刪除：14 個
刪除失敗：1 個
釋放空間：12.5 MB

刪除失敗的檔案：
  - C:\Users\test\Downloads\locked_file.dat: 權限不足，無法刪除
==================================================
```

## 常見問題

### Q: 程式顯示「權限不足」怎麼辦？
A: 請以系統管理員身分執行程式，或確認您對目標資料夾有完整的讀寫權限。

### Q: 可以復原已刪除的檔案嗎？
A: 程式直接刪除檔案（不移至資源回收筒），請確認要刪除的檔案後再執行。

### Q: 如何自動化執行？
A: 可以搭配 Windows 工作排程器，設定定期執行清理任務。

### Q: 程式會刪除系統檔案嗎？
A: 程式只會刪除指定資料夾中的檔案，不會主動掃描系統目錄。

## 注意事項

⚠️ **重要提醒**：
1. 刪除的檔案無法復原，請謹慎使用
2. 建議先在測試資料夾中試用
3. 重要檔案請先備份
4. 不建議在系統目錄中使用

## 技術支援

如有問題或建議，請查看程式日誌檔案以獲得更詳細的錯誤資訊。

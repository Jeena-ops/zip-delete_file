# 📁 檔案清理大師 File Cleanup Master

> 🚀 專業級檔案清理工具，支援系統托盤、網頁版和一鍵 EXE 打包

[![GitHub](https://img.shields.io/badge/GitHub-開源專案-blue)](https://github.com)
[![Python](https://img.shields.io/badge/Python-3.7+-green)](https://python.org)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)

## ✨ 主要功能

### 🎯 **核心清理功能**
- 🗂️ **智能檔案清理**：支援多種清理模式和檔案類型過濾
- 📦 **自動壓縮歸檔**：刪除前自動打包，節省 50%+ 空間
- 🔄 **定期清理**：支援排程自動執行
- 🎛️ **多種清理模式**：快速清理、深度清理、自訂規則

### 🖥️ **多種使用介面**
- 🎯 **系統托盤程式**：Windows 系統托盤常駐，想開就開想關就關
- 🌐 **網頁版介面**：支援多人同時使用，任何設備都可訪問
- 💻 **命令列介面**：適合進階使用者和腳本整合
- 📱 **跨平台支援**：Windows、Mac、Linux 都可使用

### 🚀 **一鍵部署**
- 📦 **EXE 打包**：一鍵生成獨立執行檔，無需安裝 Python
- 🌍 **網頁伺服器**：一鍵啟動 Web 服務，局域網任何人都可使用
- 📋 **完整部署指南**：詳細的安裝和配置說明

---

## 🚀 快速開始

### **方案1：EXE 版本（推薦給一般使用者）**

1. **一鍵打包**
   ```bash
   # 雙擊運行
   quick_build.bat
   ```

2. **使用軟體**
   - 運行生成的 `檔案清理大師.exe`
   - 程式會出現在系統托盤
   - 雙擊托盤圖標開始使用

### **方案2：網頁版（推薦給多人使用）**

1. **安裝依賴**
   ```bash
   pip install flask werkzeug pillow
   ```

2. **啟動伺服器**
   ```bash
   # 雙擊啟動
   start_web.bat
   
   # 或手動啟動
   python web_app.py
   ```

3. **瀏覽器訪問**
   - 本機：`http://localhost:5000`
   - 其他設備：`http://你的IP:5000`

### **方案3：系統托盤版**

```bash
# 直接運行系統托盤程式
python cleanup_tray.py
```

# 預覽重新命名結果
results = renamer.rename_files_in_directory("您的資料夾路徑", dry_run=True)

# 實際執行重新命名
results = renamer.rename_files_in_directory("您的資料夾路徑", dry_run=False)

# 列印摘要
renamer.print_summary(results)
```

## 檔名識別規則

程式會自動識別檔名中的以下組件：

1. **帳戶號碼**：8位以上的數字
2. **幣別**：預定義的貨幣代碼（USD、EUR、TWD等）
3. **日期**：
   - MMYYYY 格式的6位數字（如 042025）→ 轉換為 YYYYMM（如 202504）
   - YYYYMM 格式的6位數字（如 202504）→ 保持不變
   - 自動驗證月份有效性（01-12）
4. **轉帳編號**：6位以上的字母數字組合

## 智能處理特性

### 標準格式檢測
程式會自動檢測已經符合標準格式（帳戶_幣別_YYYYMM_轉帳號碼.ext）的檔案並跳過處理，避免重複轉換。

### 日期格式智能識別
- **MMYYYY → YYYYMM**：042025 轉換為 202504
- **YYYYMM → YYYYMM**：202504 保持不變
- **無效日期**：132025（13月）或 202513（13月）會被跳過

## 範例

### 輸入檔名範例：
- `123456789_USD_042025_TRF001.pdf` → 需要轉換日期
- `987654321_EUR_202505_TRF002.xlsx` → 已經是標準格式，跳過
- `TRF003_111222333_GBP_052025.doc` → 順序不同，需要重組
- `444555666_TWD_202506_TRF004.csv` → 已經是標準格式，跳過

### 輸出檔名格式：
- `123456789_USD_202504_TRF001.pdf` ✓ 日期已轉換
- `987654321_EUR_202505_TRF002.xlsx` ✓ 保持不變（已是標準格式）
- `111222333_GBP_202505_TRF003.doc` ✓ 重新排序並轉換日期
- `444555666_TWD_202506_TRF004.csv` ✓ 保持不變（已是標準格式）

### 無效檔案範例：
- `123456789_USD_132025_TRF001.pdf` ✗ 13月無效，跳過
- `123456789_USD_202513_TRF001.pdf` ✗ 13月無效，跳過
- `invalid_file.txt` ✗ 無法解析，跳過

## 支援的幣別

程式目前支援以下幣別代碼：
- USD, EUR, JPY, GBP, AUD, CAD, CHF, CNY, HKD, SGD
- TWD, KRW, THB, MYR, PHP, IDR, VND, INR, BRL, MXN

可以在程式中的 `currencies` 集合中添加更多幣別。

## 安全特性

1. **預覽模式**：默認先顯示預覽，確認後才執行
2. **智能跳過**：自動跳過已經是標準格式的檔案，避免重複處理
3. **檔案衝突檢查**：如果新檔名已存在，會跳過該檔案
4. **日期驗證**：檢查月份有效性，無效日期（如13月）會被跳過
5. **錯誤處理**：遇到無法解析的檔名會跳過並記錄
6. **備份建議**：建議在執行前備份重要檔案

## 注意事項

1. 程式只會重新命名檔案，不會修改檔案內容
2. 如果檔名缺少必要組件（帳戶、幣別、日期、轉帳編號），該檔案會被跳過
3. 建議在執行前先測試少量檔案
4. 對於重要檔案，建議先備份

## 錯誤排除

如果程式無法正確識別檔名，可能的原因：

1. **帳戶號碼格式**：確保帳戶號碼至少8位數字
2. **幣別代碼**：確保使用支援的3位字母幣別代碼
3. **日期格式**：確保日期為6位數字的MMYYYY格式
4. **轉帳編號**：確保轉帳編號至少6位字母數字組合

可以根據實際需求修改 `FileRenamer` 類別中的識別規則。

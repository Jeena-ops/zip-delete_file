# 檔案自動分類整理工具 - 快速開始指南

## 🚀 安裝和運行

### 1. 安裝依賴
```bash
pip install watchdog schedule
```

### 2. 運行程式
```bash
python allocate_file.py
```

## 🎯 主要功能演示

### 智能學習檔名格式

當您的檔案命名遵循一定格式時，程式會自動學習並創建對應的資料夾結構：

#### 📄 合同文件格式
```
檔名：合同_財務部_2025Q3.pdf
結果：OrganizedFiles/合同/財務部/2025Q3.pdf
```

#### 📊 報告文件格式  
```
檔名：報告_月報_財務部_202501.xlsx
結果：OrganizedFiles/報告/月報/財務部/202501.xlsx
```

#### 🧾 發票文件格式
```
檔名：發票_ABC公司_50000_20250115.pdf
結果：OrganizedFiles/發票/ABC公司/50000/20250115.pdf
```

#### 📸 照片文件格式
```
檔名：照片_會議_會議室A_20250125.jpg
結果：OrganizedFiles/照片/會議/會議室A/20250125.jpg
```

## 🧠 智能識別能力

### 模式簽名系統
程式會分析檔名並生成模式簽名：

- **TEXT** - 純文字 (財務部, 人事部)
- **NUMBER** - 純數字 (50000, 25000)
- **YYYY** - 四位年份 (2025)
- **YYYYMM** - 年月格式 (202501)
- **YYYYMMDD** - 完整日期 (20250115)
- **ALPHANUMERIC** - 字母數字混合 (2025Q3, v1, Q1)
- **MIXED** - 其他混合格式

### 自動學習流程
1. **檔案到達** → 分析檔名格式
2. **模式識別** → 檢查是否為已知格式
3. **結構建議** → 根據格式建議資料夾結構
4. **學習記錄** → 保存新學到的格式
5. **檔案移動** → 創建資料夾並移動檔案

## 📋 操作選單詳解

### 主選單選項

#### 選項1：掃描現有檔案並整理
- 一次性掃描監控資料夾中的所有檔案
- 根據檔名自動分類整理
- 適合初次使用或批次整理

#### 選項2：開始即時監控  
- 持續監控指定資料夾
- 新檔案自動即時分類
- 設定每日定時掃描
- 適合長期使用

#### 選項3：掃描 + 監控（推薦）
- 結合選項1和2的功能
- 先整理現有檔案，再開始監控
- 最完整的使用模式

#### 選項4：檔名模式管理
進入模式管理界面，可以：
- 查看已學習的檔名格式
- 查看新發現的格式
- 手動添加自定義格式
- 刪除不需要的格式

#### 選項5：創建設定檔並退出
- 生成 `config.txt` 設定檔
- 可自定義監控路徑、分隔符等

## ⚙️ 設定檔說明

程式會生成 `config.txt` 設定檔：

```ini
# 監控資料夾路徑
WATCH_FOLDER = "C:\Users\%USERNAME%\Downloads"

# 整理後的目標資料夾  
TARGET_FOLDER = "C:\Users\%USERNAME%\Documents\OrganizedFiles"

# 檔名分隔符
SEPARATOR = "_"

# 支援的檔案類型
SUPPORTED_EXTENSIONS = ".pdf,.docx,.xlsx,.pptx,.txt,.doc,.xls,.ppt,.jpg,.jpeg,.png,.gif,.bmp,.mp4,.avi,.mov,.mp3,.wav,.zip,.rar"

# 每日自動掃描時間（24小時制）
DAILY_SCAN_HOUR = 2
DAILY_SCAN_MINUTE = 0
```

## 📁 學習記錄檔案

程式會自動創建 `learned_patterns.json` 來保存學習到的格式：

```json
{
  "MIXED_MIXED_ALPHANUMERIC": {
    "folder_structure": ["合同", "財務部"],
    "examples": ["合同_財務部_2025Q3.pdf"],
    "count": 5,
    "last_seen": "2025-01-25T10:30:00"
  }
}
```

## 🔍 日誌和監控

### 日誌檔案位置
```
logs/file_allocator_YYYYMM.log
```

### 日誌內容示例
```
2025-01-25 10:30:15 - INFO - 檔案移動成功（新模式 MIXED_MIXED_YYYYMM）：報告_財務_202501.xlsx → 報告 > 財務/202501.xlsx
2025-01-25 10:30:16 - INFO - 學習新模式：MIXED_MIXED_YYYYMM → 報告/財務
```

## 🛠️ 實際使用步驟

### 第一次使用
1. 下載程式檔案到電腦
2. 安裝必要套件：`pip install watchdog schedule`
3. 運行：`python allocate_file.py`
4. 選擇「5」創建設定檔
5. 修改 `config.txt` 中的路徑設定
6. 重新運行程式，選擇「3」開始使用

### 日常使用
1. 將需要整理的檔案放入監控資料夾
2. 程式會自動分析檔名並分類
3. 檔案會被移動到對應的子資料夾中
4. 新的檔名格式會被自動學習

### 模式管理
1. 運行程式選擇「4」進入模式管理
2. 查看「1」已學習的模式
3. 如需自定義格式，選擇「3」手動添加
4. 可以刪除不需要的模式

## 💡 最佳實踐建議

### 檔名命名規範
- 使用一致的分隔符（預設為下劃線 `_`）
- 按重要性排序：`類型_部門_時間_詳細描述`
- 避免使用特殊字符：`< > : " / \ | ? *`

### 資料夾結構設計
- 建議2-3層資料夾結構
- 第一層：文件類型（合同、報告、發票等）
- 第二層：部門或項目
- 第三層：時間或詳細分類

### 使用技巧
- 初次使用時建議先測試小量檔案
- 重要檔案使用前請先備份
- 定期檢查日誌檔案瞭解分類情況
- 可以手動訓練特定的檔名格式

## 🔧 故障排除

### 常見問題

**Q: 檔案沒有被自動分類？**
A: 檢查檔案類型是否在支援列表中，檔名是否包含分隔符

**Q: 分類結果不符合期望？**  
A: 可以手動添加或修改模式，程式會學習新的規則

**Q: 程式運行錯誤？**
A: 檢查監控資料夾是否存在，權限是否足夠

**Q: 想要修改已學習的模式？**
A: 使用模式管理功能刪除舊模式，重新添加新模式

## 📞 支援和反饋

如果您在使用過程中遇到問題或有改進建議，歡迎提供反饋！

---

**開始享受智能檔案管理帶來的便利吧！** 🎉

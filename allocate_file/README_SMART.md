# 檔案自動分類整理工具 - 智能學習版

## 🧠 智能學習功能

這個改進版本的檔案分類工具具備智能學習能力，能夠：

1. **自動識別檔名格式**：分析檔案名稱的模式和結構
2. **學習新格式**：當遇到新的檔名格式時自動學習並記錄
3. **智能分類**：根據學習到的模式自動創建對應的資料夾結構
4. **模式管理**：提供互動介面管理已學習的檔名模式

## 📋 功能特點

### 🔍 智能模式識別
- 自動分析檔名中的不同組件（文字、數字、日期等）
- 生成模式簽名來識別相似的檔名格式
- 建議最佳的資料夾結構

### 📚 自動學習
- 遇到新檔名格式時自動學習並保存
- 記錄每種模式的使用次數和範例檔案
- 持久化保存學習結果到 `learned_patterns.json`

### 🏗️ 智能資料夾創建
- 根據檔名自動創建多層資料夾結構
- 支援動態資料夾名稱（從檔名中提取）
- 自動處理檔名衝突

## 🎯 支援的檔名格式範例

### 格式1：合同_部門_時間
```
合同_財務部_2025Q3.pdf → 合同/財務部/2025Q3.pdf
合同_人事部_2025Q4.docx → 合同/人事部/2025Q4.docx
```

### 格式2：報告_類型_部門_日期
```
報告_月報_財務部_202501.xlsx → 報告/月報/月報_202501.xlsx
報告_週報_人事部_202502.docx → 報告/週報/週報_202502.docx
```

### 格式3：發票_供應商_金額_日期
```
發票_ABC公司_50000_20250115.pdf → 發票/ABC公司/50000_20250115.pdf
```

### 格式4：專案_名稱_階段_版本
```
專案_網站改版_設計_v1.docx → 專案/網站改版/設計_v1.docx
```

## 🛠️ 使用方法

### 基本使用
```bash
python allocate_file.py
```

### 測試智能學習功能
```bash
python test_smart_allocator.py
```

## 📱 操作界面

### 主選單
1. **掃描現有檔案並整理** - 一次性整理現有檔案
2. **開始即時監控** - 持續監控新檔案
3. **掃描 + 監控** - 組合模式（推薦）
4. **檔名模式管理** - 管理學習到的模式
5. **創建設定檔並退出** - 生成配置檔案

### 模式管理選單
1. **查看已學習的模式** - 顯示所有學習到的檔名格式
2. **查看新發現的模式** - 顯示尚未確認的新格式
3. **手動添加模式** - 自定義檔名格式規則
4. **刪除模式** - 移除不需要的格式
5. **清空未知模式記錄** - 清理臨時記錄

## 🔧 智能分析示例

### 模式簽名生成
程式會將檔名分析為模式簽名：

```
合同_財務部_2025Q3.pdf
↓
模式簽名：TEXT_TEXT_ALPHANUMERIC
資料夾結構：合同 > 財務部
```

```
報告_月報_財務部_202501.xlsx
↓  
模式簽名：TEXT_TEXT_TEXT_YYYYMM
資料夾結構：報告 > 月報 > 財務部
```

### 日期格式識別
- `YYYY` - 四位年份 (2025)
- `YYYYMM` - 年月格式 (202501)
- `YYYYMMDD` - 完整日期 (20250115)
- `NUMBER` - 純數字
- `TEXT` - 純文字
- `ALPHANUMERIC` - 字母數字混合
- `MIXED` - 其他混合格式

## 📊 學習記錄

程式會記錄每種模式的詳細資訊：

```json
{
  "TEXT_TEXT_ALPHANUMERIC": {
    "folder_structure": ["合同", "財務部"],
    "examples": ["合同_財務部_2025Q3.pdf", "合同_人事部_2025Q4.docx"],
    "count": 15,
    "last_seen": "2025-01-25T10:30:00"
  }
}
```

## 🚀 進階功能

### 手動訓練模式
可以手動添加檔名格式規則：

1. 輸入範例檔名
2. 自定義資料夾結構
3. 保存為新的學習模式

### 模式優先級
- 完全匹配的已知模式優先
- 部分匹配時使用最相似的模式
- 全新格式時自動學習

### 錯誤處理
- 非法字符自動清理
- 檔名衝突自動處理
- 資料夾創建失敗時的備選方案

## 📁 檔案結構

```
allocate_file/
├── allocate_file.py           # 主程式
├── test_smart_allocator.py    # 測試程式
├── config.txt                 # 設定檔（自動生成）
├── learned_patterns.json      # 學習模式記錄（自動生成）
└── logs/                      # 日誌資料夾
    └── file_allocator_YYYYMM.log
```

## 🎯 實際使用案例

### 案例1：辦公室文件管理
```
合同_客戶A_2025Q1.pdf → 合同/客戶A/
發票_供應商B_金額_日期.pdf → 發票/供應商B/
報告_部門_類型_日期.docx → 報告/部門/
```

### 案例2：專案文件整理
```
專案_項目名_階段_版本.docx → 專案/項目名/
會議_項目_日期.pdf → 會議/項目/
設計_功能_版本.psd → 設計/功能/
```

### 案例3：個人文件分類
```
照片_事件_地點_日期.jpg → 照片/事件/
文檔_類型_主題.pdf → 文檔/類型/
音樂_歌手_專輯.mp3 → 音樂/歌手/
```

## 🔍 監控和日誌

程式會記錄詳細的操作日誌：

```
2025-01-25 10:30:15 - INFO - 檔案移動成功（新模式 TEXT_TEXT_YYYYMM）：報告_財務_202501.xlsx → 報告 > 財務/202501.xlsx
2025-01-25 10:30:16 - INFO - 學習新模式：TEXT_TEXT_YYYYMM → 報告/財務
2025-01-25 10:30:20 - INFO - 檔案移動成功（已知模式 TEXT_TEXT_YYYYMM）：報告_人事_202502.xlsx → 報告 > 人事/202502.xlsx
```

## ⚙️ 設定選項

在 `config.txt` 中可以設定：

- 監控資料夾路徑
- 目標整理資料夾
- 檔名分隔符
- 支援的檔案類型
- 自動掃描時間

## 🔮 未來擴展

計劃中的功能：
- 更多日期格式支援
- 自然語言處理改進
- 圖形化使用介面
- 雲端同步支援
- 批次重新分類功能

---

**這個智能版本讓檔案管理變得更加自動化和智能化！** 🚀

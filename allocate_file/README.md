# 檔案自動分類整理工具

## 功能介紹

這是一個智能檔案管理工具，可以：

1. **即時監控**：持續監控指定資料夾（如 Downloads），自動處理新加入的檔案
2. **智能分類**：根據檔名中的分類資訊自動建立資料夾結構
3. **自動移動**：將檔案移動到對應的分類資料夾中
4. **定時掃描**：每日自動掃描並整理檔案
5. **詳細日誌**：記錄所有操作，方便追蹤

## 檔名格式規則

程式會根據檔名中的下劃線（_）來解析分類資訊：

### 範例格式

```
分類1_分類2_檔案名稱.副檔名
```

### 實際範例

| 原檔名 | 分類結果 | 目標路徑 |
|--------|----------|----------|
| `合同_財務部_2025Q3.pdf` | 合同 > 財務部 | `OrganizedFiles/合同/財務部/2025Q3.pdf` |
| `報告_人事_月報_202501.docx` | 報告 > 人事 | `OrganizedFiles/報告/人事/月報_202501.docx` |
| `照片_旅遊_日本_2025.jpg` | 照片 > 旅遊 | `OrganizedFiles/照片/旅遊/日本_2025.jpg` |
| `發票_會計_電費_202501.pdf` | 發票 > 會計 | `OrganizedFiles/發票/會計/電費_202501.pdf` |

## 支援的檔案類型

- **文件**：.pdf, .docx, .xlsx, .pptx, .txt, .doc, .xls, .ppt
- **圖片**：.jpg, .jpeg, .png, .gif, .bmp, .tiff
- **影片**：.mp4, .avi, .mov, .wmv, .flv, .mkv
- **音樂**：.mp3, .wav, .flac, .aac, .ogg
- **壓縮檔**：.zip, .rar, .7z, .tar, .gz

## 安裝與設定

### 1. 安裝依賴套件

```bash
pip install -r requirements.txt
```

### 2. 執行程式

```bash
python allocate_file.py
```

### 3. 選擇操作模式

程式提供四種操作模式：

1. **掃描現有檔案並整理** - 一次性整理現有檔案
2. **開始即時監控** - 持續監控新檔案
3. **掃描 + 監控（推薦）** - 先整理現有檔案，然後開始監控
4. **創建設定檔並退出** - 生成可自定義的設定檔

## 自定義設定

首次執行時選擇選項 4 創建設定檔，然後編輯 `config.txt`：

```ini
# 監控資料夾路徑
WATCH_FOLDER = "C:\Users\%USERNAME%\Downloads"

# 整理後的目標資料夾
TARGET_FOLDER = "C:\Users\%USERNAME%\Documents\OrganizedFiles"

# 檔名分隔符
SEPARATOR = "_"

# 支援的檔案類型
SUPPORTED_EXTENSIONS = ".pdf,.docx,.xlsx,.pptx,.txt,.doc,.xls,.ppt,.jpg,.jpeg,.png,.gif,.bmp,.mp4,.avi,.mov,.mp3,.wav,.zip,.rar"

# 每日自動掃描時間（24小時制）
DAILY_SCAN_HOUR = 2
DAILY_SCAN_MINUTE = 0
```

## 開機自動啟動

### Windows 方法 1：工作排程器

1. 打開「工作排程器」
2. 點擊「建立基本工作」
3. 設定名稱：「檔案自動整理」
4. 觸發程序：「當電腦啟動時」
5. 動作：「啟動程式」
6. 程式：`python.exe`
7. 引數：`"完整路徑\allocate_file.py"`

### Windows 方法 2：啟動資料夾

1. 創建批次檔 `start_allocator.bat`：
```batch
@echo off
cd /d "C:\path\to\your\script"
python allocate_file.py
```

2. 將批次檔放入啟動資料夾：
   - 按 `Win + R`，輸入 `shell:startup`
   - 將批次檔複製到打開的資料夾

## 日誌記錄

程式會在 `logs` 資料夾中記錄操作日誌：

- 檔案移動記錄
- 錯誤訊息
- 系統狀態

日誌檔案按月份分類：`file_allocator_YYYYMM.log`

## 使用技巧

### 1. 建議的檔名命名規則

```
大分類_小分類_描述_日期.副檔名
```

例如：
- `工作_專案A_需求文件_20250125.docx`
- `個人_財務_銀行對帳單_202501.pdf`
- `學習_程式設計_Python教學_基礎篇.pdf`

### 2. 避免檔名衝突

程式會自動處理檔名衝突，在重複檔名後添加編號：
- `原檔案.pdf`
- `原檔案_1.pdf`
- `原檔案_2.pdf`

### 3. 特殊情況處理

- **無分隔符的檔案**：會被放入「未分類」資料夾
- **非法字符**：會自動替換為 `-`
- **空分類**：會被替換為「未知」

## 故障排除

### 常見問題

1. **程式無法啟動**
   - 檢查 Python 是否正確安裝
   - 確認依賴套件已安裝：`pip install -r requirements.txt`

2. **監控資料夾不存在**
   - 檢查設定檔中的路徑是否正確
   - 確認資料夾存在且有讀取權限

3. **檔案移動失敗**
   - 檢查目標資料夾是否有寫入權限
   - 確認檔案未被其他程式佔用

4. **分類錯誤**
   - 檢查檔名是否符合命名規則
   - 確認分隔符設定正確

### 日誌查看

查看最新的日誌檔案以獲取詳細錯誤資訊：

```bash
# Windows
type logs\file_allocator_202501.log

# 或在程式中查看即時日誌輸出
```

## 進階功能

### 自定義分類規則

可以修改 `parse_filename` 方法來實現更複雜的分類邏輯：

- 正則表達式匹配
- 日期格式識別
- 檔案大小分類
- 特定關鍵字分類

### 雲端同步

配合雲端儲存服務（OneDrive、Google Drive 等），可以實現：

- 跨裝置檔案同步
- 自動備份重要分類
- 遠端存取整理後的檔案

---

**開始使用，讓您的檔案管理更輕鬆！** 📁✨
